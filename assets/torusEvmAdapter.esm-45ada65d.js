import{r as Yt,a as et,c as $,b as W,d as Xt,B as It,e as tt,i as _e,f as zt,l as Zt,S as Pt,_ as b,g as Mt,O as Jt,p as Fe,h as Qt,J as er,j as tr,k as de,m as rr,n as ir,o as at,s as nr,E as sr,q as ar,t as or,W as Te,A as lr,C as ur,u as dr,v as K,w as Ge,x as $e,y as Ae,z as hr,D as ot}from"./index-6f172409.js";import{i as cr,f as fr}from"./index-c5dcf017.js";import{B as pr}from"./baseEvmAdapter.esm-5e3e671c.js";var Qe={},Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.storeAsStream=void 0;const gr=Yt;class mr extends gr.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=t=>this.push(t),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const i=super.pipe(e,t);return e.write(this.obsStore.getState()),i}_write(e,t,i){this.obsStore.putState(e),i()}_read(e){}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}function yr(r){return new mr(r)}Pe.storeAsStream=yr;var Me={},pe={},rt={};Object.defineProperty(rt,"__esModule",{value:!0});const wr=et;function lt(r,e,t){try{Reflect.apply(r,e,t)}catch(i){setTimeout(()=>{throw i})}}function br(r){const e=r.length,t=new Array(e);for(let i=0;i<e;i+=1)t[i]=r[i];return t}class vr extends wr.EventEmitter{emit(e,...t){let i=e==="error";const a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){let d;if(t.length>0&&([d]=t),d instanceof Error)throw d;const c=new Error(`Unhandled error.${d?` (${d.message})`:""}`);throw c.context=d,c}const o=a[e];if(o===void 0)return!1;if(typeof o=="function")lt(o,this,t);else{const d=o.length,c=br(o);for(let p=0;p<d;p+=1)lt(c[p],this,t)}return!0}}rt.default=vr;var _r=$&&$.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(pe,"__esModule",{value:!0});pe.ObservableStore=void 0;const Sr=_r(rt);class Cr extends Sr.default{constructor(e){super(),e?this._state=e:this._state={}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&typeof e=="object"){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}pe.ObservableStore=Cr;Object.defineProperty(Me,"__esModule",{value:!0});Me.ComposedStore=void 0;const Er=pe;class Tr extends Er.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach(t=>{const i=this._children[t];this._addChild(t,i)})}_addChild(e,t){const i=a=>{const o=this.getState();o[e]=a,this.putState(o)};t.subscribe(i),i(t.getState())}}Me.ComposedStore=Tr;var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.MergedStore=void 0;const Ar=pe;class Dr extends Ar.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach(t=>this._addChild(t)),this._updateWholeState()}_addChild(e){e.subscribe(()=>this._updateWholeState())}_updateWholeState(){const e=this._children.map(i=>i.getState()),t=Object.assign({},...e);this.putState(t)}}Ne.MergedStore=Dr;var Le={},be={},Rr={get exports(){return be},set exports(r){be=r}},Oe={},Or={get exports(){return Oe},set exports(r){Oe=r}},he={},ut={get exports(){return he},set exports(r){he=r}};typeof W>"u"||!W.version||W.version.indexOf("v0.")===0||W.version.indexOf("v1.")===0&&W.version.indexOf("v1.8.")!==0?ut.exports={nextTick:Ir}:ut.exports=W;function Ir(r,e,t,i){if(typeof r!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,o,d;switch(a){case 0:case 1:return W.nextTick(r);case 2:return W.nextTick(function(){r.call(null,e)});case 3:return W.nextTick(function(){r.call(null,e,t)});case 4:return W.nextTick(function(){r.call(null,e,t,i)});default:for(o=new Array(a-1),d=0;d<o.length;)o[d++]=arguments[d];return W.nextTick(function(){r.apply(null,o)})}}var Pr={}.toString,Mr=Array.isArray||function(r){return Pr.call(r)=="[object Array]"},Nt=et.EventEmitter,se={},Nr={get exports(){return se},set exports(r){se=r}};(function(r,e){var t=Xt,i=t.Buffer;function a(d,c){for(var p in d)c[p]=d[p]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?r.exports=t:(a(t,e),e.Buffer=o);function o(d,c,p){return i(d,c,p)}a(i,o),o.from=function(d,c,p){if(typeof d=="number")throw new TypeError("Argument must not be a number");return i(d,c,p)},o.alloc=function(d,c,p){if(typeof d!="number")throw new TypeError("Argument must be a number");var _=i(d);return c!==void 0?typeof p=="string"?_.fill(c,p):_.fill(c):_.fill(0),_},o.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return i(d)},o.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(d)}})(Nr,se);var x={};function Lr(r){return Array.isArray?Array.isArray(r):Ue(r)==="[object Array]"}x.isArray=Lr;function Ur(r){return typeof r=="boolean"}x.isBoolean=Ur;function kr(r){return r===null}x.isNull=kr;function xr(r){return r==null}x.isNullOrUndefined=xr;function Br(r){return typeof r=="number"}x.isNumber=Br;function Wr(r){return typeof r=="string"}x.isString=Wr;function Hr(r){return typeof r=="symbol"}x.isSymbol=Hr;function jr(r){return r===void 0}x.isUndefined=jr;function Vr(r){return Ue(r)==="[object RegExp]"}x.isRegExp=Vr;function qr(r){return typeof r=="object"&&r!==null}x.isObject=qr;function Kr(r){return Ue(r)==="[object Date]"}x.isDate=Kr;function Fr(r){return Ue(r)==="[object Error]"||r instanceof Error}x.isError=Fr;function Gr(r){return typeof r=="function"}x.isFunction=Gr;function $r(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r>"u"}x.isPrimitive=$r;x.isBuffer=It.isBuffer;function Ue(r){return Object.prototype.toString.call(r)}var Ie={},Yr={get exports(){return Ie},set exports(r){Ie=r}},dt;function Xr(){return dt||(dt=1,function(r){function e(o,d){if(!(o instanceof d))throw new TypeError("Cannot call a class as a function")}var t=se.Buffer,i=tt;function a(o,d,c){o.copy(d,c)}r.exports=function(){function o(){e(this,o),this.head=null,this.tail=null,this.length=0}return o.prototype.push=function(c){var p={data:c,next:null};this.length>0?this.tail.next=p:this.head=p,this.tail=p,++this.length},o.prototype.unshift=function(c){var p={data:c,next:this.head};this.length===0&&(this.tail=p),this.head=p,++this.length},o.prototype.shift=function(){if(this.length!==0){var c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}},o.prototype.clear=function(){this.head=this.tail=null,this.length=0},o.prototype.join=function(c){if(this.length===0)return"";for(var p=this.head,_=""+p.data;p=p.next;)_+=c+p.data;return _},o.prototype.concat=function(c){if(this.length===0)return t.alloc(0);for(var p=t.allocUnsafe(c>>>0),_=this.head,v=0;_;)a(_.data,p,v),v+=_.data.length,_=_.next;return p},o}(),i&&i.inspect&&i.inspect.custom&&(r.exports.prototype[i.inspect.custom]=function(){var o=i.inspect({length:this.length});return this.constructor.name+" "+o})}(Yr)),Ie}var De=he;function zr(r,e){var t=this,i=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return i||a?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,De.nextTick(Re,this,r)):De.nextTick(Re,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(o){!e&&o?t._writableState?t._writableState.errorEmitted||(t._writableState.errorEmitted=!0,De.nextTick(Re,t,o)):De.nextTick(Re,t,o):e&&e(o)}),this)}function Zr(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Re(r,e){r.emit("error",e)}var Lt={destroy:zr,undestroy:Zr},Ye,ht;function Ut(){if(ht)return Ye;ht=1;var r=he;Ye=E;function e(l){var u=this;this.next=null,this.entry=null,this.finish=function(){We(u,l)}}var t=!W.browser&&["v0.10","v0.9."].indexOf(W.version.slice(0,5))>-1?setImmediate:r.nextTick,i;E.WritableState=N;var a=Object.create(x);a.inherits=_e;var o={deprecate:zt},d=Nt,c=se.Buffer,p=(typeof $<"u"?$:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function _(l){return c.from(l)}function v(l){return c.isBuffer(l)||l instanceof p}var y=Lt;a.inherits(E,d);function R(){}function N(l,u){i=i||ce(),l=l||{};var g=u instanceof i;this.objectMode=!!l.objectMode,g&&(this.objectMode=this.objectMode||!!l.writableObjectMode);var S=l.highWaterMark,D=l.writableHighWaterMark,P=this.objectMode?16:16*1024;S||S===0?this.highWaterMark=S:g&&(D||D===0)?this.highWaterMark=D:this.highWaterMark=P,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var V=l.decodeStrings===!1;this.decodeStrings=!V,this.defaultEncoding=l.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(q){z(u,q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}N.prototype.getBuffer=function(){for(var u=this.bufferedRequest,g=[];u;)g.push(u),u=u.next;return g},function(){try{Object.defineProperty(N.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var O;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(O=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(l){return O.call(this,l)?!0:this!==E?!1:l&&l._writableState instanceof N}})):O=function(l){return l instanceof this};function E(l){if(i=i||ce(),!O.call(E,this)&&!(this instanceof i))return new E(l);this._writableState=new N(l,this),this.writable=!0,l&&(typeof l.write=="function"&&(this._write=l.write),typeof l.writev=="function"&&(this._writev=l.writev),typeof l.destroy=="function"&&(this._destroy=l.destroy),typeof l.final=="function"&&(this._final=l.final)),d.call(this)}E.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function H(l,u){var g=new Error("write after end");l.emit("error",g),r.nextTick(u,g)}function h(l,u,g,S){var D=!0,P=!1;return g===null?P=new TypeError("May not write null values to stream"):typeof g!="string"&&g!==void 0&&!u.objectMode&&(P=new TypeError("Invalid non-string/buffer chunk")),P&&(l.emit("error",P),r.nextTick(S,P),D=!1),D}E.prototype.write=function(l,u,g){var S=this._writableState,D=!1,P=!S.objectMode&&v(l);return P&&!c.isBuffer(l)&&(l=_(l)),typeof u=="function"&&(g=u,u=null),P?u="buffer":u||(u=S.defaultEncoding),typeof g!="function"&&(g=R),S.ended?H(this,g):(P||h(this,S,l,g))&&(S.pendingcb++,D=T(this,S,P,l,u,g)),D},E.prototype.cork=function(){var l=this._writableState;l.corked++},E.prototype.uncork=function(){var l=this._writableState;l.corked&&(l.corked--,!l.writing&&!l.corked&&!l.bufferProcessing&&l.bufferedRequest&&oe(this,l))},E.prototype.setDefaultEncoding=function(u){if(typeof u=="string"&&(u=u.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((u+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+u);return this._writableState.defaultEncoding=u,this};function m(l,u,g){return!l.objectMode&&l.decodeStrings!==!1&&typeof u=="string"&&(u=c.from(u,g)),u}Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function T(l,u,g,S,D,P){if(!g){var V=m(u,S,D);S!==V&&(g=!0,D="buffer",S=V)}var q=u.objectMode?1:S.length;u.length+=q;var ee=u.length<u.highWaterMark;if(ee||(u.needDrain=!0),u.writing||u.corked){var te=u.lastBufferedRequest;u.lastBufferedRequest={chunk:S,encoding:D,isBuf:g,callback:P,next:null},te?te.next=u.lastBufferedRequest:u.bufferedRequest=u.lastBufferedRequest,u.bufferedRequestCount+=1}else U(l,u,!1,q,S,D,P);return ee}function U(l,u,g,S,D,P,V){u.writelen=S,u.writecb=V,u.writing=!0,u.sync=!0,g?l._writev(D,u.onwrite):l._write(D,P,u.onwrite),u.sync=!1}function L(l,u,g,S,D){--u.pendingcb,g?(r.nextTick(D,S),r.nextTick(Q,l,u),l._writableState.errorEmitted=!0,l.emit("error",S)):(D(S),l._writableState.errorEmitted=!0,l.emit("error",S),Q(l,u))}function X(l){l.writing=!1,l.writecb=null,l.length-=l.writelen,l.writelen=0}function z(l,u){var g=l._writableState,S=g.sync,D=g.writecb;if(X(g),u)L(l,g,S,u,D);else{var P=F(g);!P&&!g.corked&&!g.bufferProcessing&&g.bufferedRequest&&oe(l,g),S?t(Z,l,g,P,D):Z(l,g,P,D)}}function Z(l,u,g,S){g||ae(l,u),u.pendingcb--,S(),Q(l,u)}function ae(l,u){u.length===0&&u.needDrain&&(u.needDrain=!1,l.emit("drain"))}function oe(l,u){u.bufferProcessing=!0;var g=u.bufferedRequest;if(l._writev&&g&&g.next){var S=u.bufferedRequestCount,D=new Array(S),P=u.corkedRequestsFree;P.entry=g;for(var V=0,q=!0;g;)D[V]=g,g.isBuf||(q=!1),g=g.next,V+=1;D.allBuffers=q,U(l,u,!0,u.length,D,"",P.finish),u.pendingcb++,u.lastBufferedRequest=null,P.next?(u.corkedRequestsFree=P.next,P.next=null):u.corkedRequestsFree=new e(u),u.bufferedRequestCount=0}else{for(;g;){var ee=g.chunk,te=g.encoding,n=g.callback,s=u.objectMode?1:ee.length;if(U(l,u,!1,s,ee,te,n),g=g.next,u.bufferedRequestCount--,u.writing)break}g===null&&(u.lastBufferedRequest=null)}u.bufferedRequest=g,u.bufferProcessing=!1}E.prototype._write=function(l,u,g){g(new Error("_write() is not implemented"))},E.prototype._writev=null,E.prototype.end=function(l,u,g){var S=this._writableState;typeof l=="function"?(g=l,l=null,u=null):typeof u=="function"&&(g=u,u=null),l!=null&&this.write(l,u),S.corked&&(S.corked=1,this.uncork()),S.ending||Be(this,S,g)};function F(l){return l.ending&&l.length===0&&l.bufferedRequest===null&&!l.finished&&!l.writing}function Se(l,u){l._final(function(g){u.pendingcb--,g&&l.emit("error",g),u.prefinished=!0,l.emit("prefinish"),Q(l,u)})}function Ce(l,u){!u.prefinished&&!u.finalCalled&&(typeof l._final=="function"?(u.pendingcb++,u.finalCalled=!0,r.nextTick(Se,l,u)):(u.prefinished=!0,l.emit("prefinish")))}function Q(l,u){var g=F(u);return g&&(Ce(l,u),u.pendingcb===0&&(u.finished=!0,l.emit("finish"))),g}function Be(l,u,g){u.ending=!0,Q(l,u),g&&(u.finished?r.nextTick(g):l.once("finish",g)),u.ended=!0,l.writable=!1}function We(l,u,g){var S=l.entry;for(l.entry=null;S;){var D=S.callback;u.pendingcb--,D(g),S=S.next}u.corkedRequestsFree.next=l}return Object.defineProperty(E.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(l){this._writableState&&(this._writableState.destroyed=l)}}),E.prototype.destroy=y.destroy,E.prototype._undestroy=y.undestroy,E.prototype._destroy=function(l,u){this.end(),u(l)},Ye}var Xe,ct;function ce(){if(ct)return Xe;ct=1;var r=he,e=Object.keys||function(y){var R=[];for(var N in y)R.push(N);return R};Xe=p;var t=Object.create(x);t.inherits=_e;var i=kt(),a=Ut();t.inherits(p,i);for(var o=e(a.prototype),d=0;d<o.length;d++){var c=o[d];p.prototype[c]||(p.prototype[c]=a.prototype[c])}function p(y){if(!(this instanceof p))return new p(y);i.call(this,y),a.call(this,y),y&&y.readable===!1&&(this.readable=!1),y&&y.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,y&&y.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",_)}Object.defineProperty(p.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function _(){this.allowHalfOpen||this._writableState.ended||r.nextTick(v,this)}function v(y){y.end()}return Object.defineProperty(p.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),p.prototype._destroy=function(y,R){this.push(null),this.end(),r.nextTick(R,y)},Xe}var ze={},ft;function pt(){if(ft)return ze;ft=1;var r=se.Buffer,e=r.isEncoding||function(h){switch(h=""+h,h&&h.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(h){if(!h)return"utf8";for(var m;;)switch(h){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return h;default:if(m)return;h=(""+h).toLowerCase(),m=!0}}function i(h){var m=t(h);if(typeof m!="string"&&(r.isEncoding===e||!e(h)))throw new Error("Unknown encoding: "+h);return m||h}ze.StringDecoder=a;function a(h){this.encoding=i(h);var m;switch(this.encoding){case"utf16le":this.text=y,this.end=R,m=4;break;case"utf8":this.fillLast=p,m=4;break;case"base64":this.text=N,this.end=O,m=3;break;default:this.write=E,this.end=H;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(m)}a.prototype.write=function(h){if(h.length===0)return"";var m,T;if(this.lastNeed){if(m=this.fillLast(h),m===void 0)return"";T=this.lastNeed,this.lastNeed=0}else T=0;return T<h.length?m?m+this.text(h,T):this.text(h,T):m||""},a.prototype.end=v,a.prototype.text=_,a.prototype.fillLast=function(h){if(this.lastNeed<=h.length)return h.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);h.copy(this.lastChar,this.lastTotal-this.lastNeed,0,h.length),this.lastNeed-=h.length};function o(h){return h<=127?0:h>>5===6?2:h>>4===14?3:h>>3===30?4:h>>6===2?-1:-2}function d(h,m,T){var U=m.length-1;if(U<T)return 0;var L=o(m[U]);return L>=0?(L>0&&(h.lastNeed=L-1),L):--U<T||L===-2?0:(L=o(m[U]),L>=0?(L>0&&(h.lastNeed=L-2),L):--U<T||L===-2?0:(L=o(m[U]),L>=0?(L>0&&(L===2?L=0:h.lastNeed=L-3),L):0))}function c(h,m,T){if((m[0]&192)!==128)return h.lastNeed=0,"�";if(h.lastNeed>1&&m.length>1){if((m[1]&192)!==128)return h.lastNeed=1,"�";if(h.lastNeed>2&&m.length>2&&(m[2]&192)!==128)return h.lastNeed=2,"�"}}function p(h){var m=this.lastTotal-this.lastNeed,T=c(this,h);if(T!==void 0)return T;if(this.lastNeed<=h.length)return h.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);h.copy(this.lastChar,m,0,h.length),this.lastNeed-=h.length}function _(h,m){var T=d(this,h,m);if(!this.lastNeed)return h.toString("utf8",m);this.lastTotal=T;var U=h.length-(T-this.lastNeed);return h.copy(this.lastChar,0,U),h.toString("utf8",m,U)}function v(h){var m=h&&h.length?this.write(h):"";return this.lastNeed?m+"�":m}function y(h,m){if((h.length-m)%2===0){var T=h.toString("utf16le",m);if(T){var U=T.charCodeAt(T.length-1);if(U>=55296&&U<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=h[h.length-2],this.lastChar[1]=h[h.length-1],T.slice(0,-1)}return T}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=h[h.length-1],h.toString("utf16le",m,h.length-1)}function R(h){var m=h&&h.length?this.write(h):"";if(this.lastNeed){var T=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,T)}return m}function N(h,m){var T=(h.length-m)%3;return T===0?h.toString("base64",m):(this.lastNeed=3-T,this.lastTotal=3,T===1?this.lastChar[0]=h[h.length-1]:(this.lastChar[0]=h[h.length-2],this.lastChar[1]=h[h.length-1]),h.toString("base64",m,h.length-T))}function O(h){var m=h&&h.length?this.write(h):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function E(h){return h.toString(this.encoding)}function H(h){return h&&h.length?this.write(h):""}return ze}var Ze,gt;function kt(){if(gt)return Ze;gt=1;var r=he;Ze=m;var e=Mr,t;m.ReadableState=h,et.EventEmitter;var i=function(n,s){return n.listeners(s).length},a=Nt,o=se.Buffer,d=(typeof $<"u"?$:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c(n){return o.from(n)}function p(n){return o.isBuffer(n)||n instanceof d}var _=Object.create(x);_.inherits=_e;var v=tt,y=void 0;v&&v.debuglog?y=v.debuglog("stream"):y=function(){};var R=Xr(),N=Lt,O;_.inherits(m,a);var E=["error","close","destroy","pause","resume"];function H(n,s,f){if(typeof n.prependListener=="function")return n.prependListener(s,f);!n._events||!n._events[s]?n.on(s,f):e(n._events[s])?n._events[s].unshift(f):n._events[s]=[f,n._events[s]]}function h(n,s){t=t||ce(),n=n||{};var f=s instanceof t;this.objectMode=!!n.objectMode,f&&(this.objectMode=this.objectMode||!!n.readableObjectMode);var w=n.highWaterMark,I=n.readableHighWaterMark,C=this.objectMode?16:16*1024;w||w===0?this.highWaterMark=w:f&&(I||I===0)?this.highWaterMark=I:this.highWaterMark=C,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new R,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(O||(O=pt().StringDecoder),this.decoder=new O(n.encoding),this.encoding=n.encoding)}function m(n){if(t=t||ce(),!(this instanceof m))return new m(n);this._readableState=new h(n,this),this.readable=!0,n&&(typeof n.read=="function"&&(this._read=n.read),typeof n.destroy=="function"&&(this._destroy=n.destroy)),a.call(this)}Object.defineProperty(m.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(n){this._readableState&&(this._readableState.destroyed=n)}}),m.prototype.destroy=N.destroy,m.prototype._undestroy=N.undestroy,m.prototype._destroy=function(n,s){this.push(null),s(n)},m.prototype.push=function(n,s){var f=this._readableState,w;return f.objectMode?w=!0:typeof n=="string"&&(s=s||f.defaultEncoding,s!==f.encoding&&(n=o.from(n,s),s=""),w=!0),T(this,n,s,!1,w)},m.prototype.unshift=function(n){return T(this,n,null,!0,!1)};function T(n,s,f,w,I){var C=n._readableState;if(s===null)C.reading=!1,oe(n,C);else{var A;I||(A=L(C,s)),A?n.emit("error",A):C.objectMode||s&&s.length>0?(typeof s!="string"&&!C.objectMode&&Object.getPrototypeOf(s)!==o.prototype&&(s=c(s)),w?C.endEmitted?n.emit("error",new Error("stream.unshift() after end event")):U(n,C,s,!0):C.ended?n.emit("error",new Error("stream.push() after EOF")):(C.reading=!1,C.decoder&&!f?(s=C.decoder.write(s),C.objectMode||s.length!==0?U(n,C,s,!1):Ce(n,C)):U(n,C,s,!1))):w||(C.reading=!1)}return X(C)}function U(n,s,f,w){s.flowing&&s.length===0&&!s.sync?(n.emit("data",f),n.read(0)):(s.length+=s.objectMode?1:f.length,w?s.buffer.unshift(f):s.buffer.push(f),s.needReadable&&F(n)),Ce(n,s)}function L(n,s){var f;return!p(s)&&typeof s!="string"&&s!==void 0&&!n.objectMode&&(f=new TypeError("Invalid non-string/buffer chunk")),f}function X(n){return!n.ended&&(n.needReadable||n.length<n.highWaterMark||n.length===0)}m.prototype.isPaused=function(){return this._readableState.flowing===!1},m.prototype.setEncoding=function(n){return O||(O=pt().StringDecoder),this._readableState.decoder=new O(n),this._readableState.encoding=n,this};var z=8388608;function Z(n){return n>=z?n=z:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function ae(n,s){return n<=0||s.length===0&&s.ended?0:s.objectMode?1:n!==n?s.flowing&&s.length?s.buffer.head.data.length:s.length:(n>s.highWaterMark&&(s.highWaterMark=Z(n)),n<=s.length?n:s.ended?s.length:(s.needReadable=!0,0))}m.prototype.read=function(n){y("read",n),n=parseInt(n,10);var s=this._readableState,f=n;if(n!==0&&(s.emittedReadable=!1),n===0&&s.needReadable&&(s.length>=s.highWaterMark||s.ended))return y("read: emitReadable",s.length,s.ended),s.length===0&&s.ended?q(this):F(this),null;if(n=ae(n,s),n===0&&s.ended)return s.length===0&&q(this),null;var w=s.needReadable;y("need readable",w),(s.length===0||s.length-n<s.highWaterMark)&&(w=!0,y("length less than watermark",w)),s.ended||s.reading?(w=!1,y("reading or ended",w)):w&&(y("do read"),s.reading=!0,s.sync=!0,s.length===0&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,s.reading||(n=ae(f,s)));var I;return n>0?I=S(n,s):I=null,I===null?(s.needReadable=!0,n=0):s.length-=n,s.length===0&&(s.ended||(s.needReadable=!0),f!==n&&s.ended&&q(this)),I!==null&&this.emit("data",I),I};function oe(n,s){if(!s.ended){if(s.decoder){var f=s.decoder.end();f&&f.length&&(s.buffer.push(f),s.length+=s.objectMode?1:f.length)}s.ended=!0,F(n)}}function F(n){var s=n._readableState;s.needReadable=!1,s.emittedReadable||(y("emitReadable",s.flowing),s.emittedReadable=!0,s.sync?r.nextTick(Se,n):Se(n))}function Se(n){y("emit readable"),n.emit("readable"),g(n)}function Ce(n,s){s.readingMore||(s.readingMore=!0,r.nextTick(Q,n,s))}function Q(n,s){for(var f=s.length;!s.reading&&!s.flowing&&!s.ended&&s.length<s.highWaterMark&&(y("maybeReadMore read 0"),n.read(0),f!==s.length);)f=s.length;s.readingMore=!1}m.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},m.prototype.pipe=function(n,s){var f=this,w=this._readableState;switch(w.pipesCount){case 0:w.pipes=n;break;case 1:w.pipes=[w.pipes,n];break;default:w.pipes.push(n);break}w.pipesCount+=1,y("pipe count=%d opts=%j",w.pipesCount,s);var I=(!s||s.end!==!1)&&n!==W.stdout&&n!==W.stderr,C=I?Ee:ge;w.endEmitted?r.nextTick(C):f.once("end",C),n.on("unpipe",A);function A(le,me){y("onunpipe"),le===f&&me&&me.hasUnpiped===!1&&(me.hasUnpiped=!0,$t())}function Ee(){y("onend"),n.end()}var He=Be(f);n.on("drain",He);var nt=!1;function $t(){y("cleanup"),n.removeListener("close",qe),n.removeListener("finish",Ke),n.removeListener("drain",He),n.removeListener("error",Ve),n.removeListener("unpipe",A),f.removeListener("end",Ee),f.removeListener("end",ge),f.removeListener("data",st),nt=!0,w.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&He()}var je=!1;f.on("data",st);function st(le){y("ondata"),je=!1;var me=n.write(le);me===!1&&!je&&((w.pipesCount===1&&w.pipes===n||w.pipesCount>1&&te(w.pipes,n)!==-1)&&!nt&&(y("false write response, pause",w.awaitDrain),w.awaitDrain++,je=!0),f.pause())}function Ve(le){y("onerror",le),ge(),n.removeListener("error",Ve),i(n,"error")===0&&n.emit("error",le)}H(n,"error",Ve);function qe(){n.removeListener("finish",Ke),ge()}n.once("close",qe);function Ke(){y("onfinish"),n.removeListener("close",qe),ge()}n.once("finish",Ke);function ge(){y("unpipe"),f.unpipe(n)}return n.emit("pipe",f),w.flowing||(y("pipe resume"),f.resume()),n};function Be(n){return function(){var s=n._readableState;y("pipeOnDrain",s.awaitDrain),s.awaitDrain&&s.awaitDrain--,s.awaitDrain===0&&i(n,"data")&&(s.flowing=!0,g(n))}}m.prototype.unpipe=function(n){var s=this._readableState,f={hasUnpiped:!1};if(s.pipesCount===0)return this;if(s.pipesCount===1)return n&&n!==s.pipes?this:(n||(n=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,n&&n.emit("unpipe",this,f),this);if(!n){var w=s.pipes,I=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var C=0;C<I;C++)w[C].emit("unpipe",this,{hasUnpiped:!1});return this}var A=te(s.pipes,n);return A===-1?this:(s.pipes.splice(A,1),s.pipesCount-=1,s.pipesCount===1&&(s.pipes=s.pipes[0]),n.emit("unpipe",this,f),this)},m.prototype.on=function(n,s){var f=a.prototype.on.call(this,n,s);if(n==="data")this._readableState.flowing!==!1&&this.resume();else if(n==="readable"){var w=this._readableState;!w.endEmitted&&!w.readableListening&&(w.readableListening=w.needReadable=!0,w.emittedReadable=!1,w.reading?w.length&&F(this):r.nextTick(We,this))}return f},m.prototype.addListener=m.prototype.on;function We(n){y("readable nexttick read 0"),n.read(0)}m.prototype.resume=function(){var n=this._readableState;return n.flowing||(y("resume"),n.flowing=!0,l(this,n)),this};function l(n,s){s.resumeScheduled||(s.resumeScheduled=!0,r.nextTick(u,n,s))}function u(n,s){s.reading||(y("resume read 0"),n.read(0)),s.resumeScheduled=!1,s.awaitDrain=0,n.emit("resume"),g(n),s.flowing&&!s.reading&&n.read(0)}m.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function g(n){var s=n._readableState;for(y("flow",s.flowing);s.flowing&&n.read()!==null;);}m.prototype.wrap=function(n){var s=this,f=this._readableState,w=!1;n.on("end",function(){if(y("wrapped end"),f.decoder&&!f.ended){var A=f.decoder.end();A&&A.length&&s.push(A)}s.push(null)}),n.on("data",function(A){if(y("wrapped data"),f.decoder&&(A=f.decoder.write(A)),!(f.objectMode&&A==null)&&!(!f.objectMode&&(!A||!A.length))){var Ee=s.push(A);Ee||(w=!0,n.pause())}});for(var I in n)this[I]===void 0&&typeof n[I]=="function"&&(this[I]=function(A){return function(){return n[A].apply(n,arguments)}}(I));for(var C=0;C<E.length;C++)n.on(E[C],this.emit.bind(this,E[C]));return this._read=function(A){y("wrapped _read",A),w&&(w=!1,n.resume())},this},Object.defineProperty(m.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),m._fromList=S;function S(n,s){if(s.length===0)return null;var f;return s.objectMode?f=s.buffer.shift():!n||n>=s.length?(s.decoder?f=s.buffer.join(""):s.buffer.length===1?f=s.buffer.head.data:f=s.buffer.concat(s.length),s.buffer.clear()):f=D(n,s.buffer,s.decoder),f}function D(n,s,f){var w;return n<s.head.data.length?(w=s.head.data.slice(0,n),s.head.data=s.head.data.slice(n)):n===s.head.data.length?w=s.shift():w=f?P(n,s):V(n,s),w}function P(n,s){var f=s.head,w=1,I=f.data;for(n-=I.length;f=f.next;){var C=f.data,A=n>C.length?C.length:n;if(A===C.length?I+=C:I+=C.slice(0,n),n-=A,n===0){A===C.length?(++w,f.next?s.head=f.next:s.head=s.tail=null):(s.head=f,f.data=C.slice(A));break}++w}return s.length-=w,I}function V(n,s){var f=o.allocUnsafe(n),w=s.head,I=1;for(w.data.copy(f),n-=w.data.length;w=w.next;){var C=w.data,A=n>C.length?C.length:n;if(C.copy(f,f.length-n,0,A),n-=A,n===0){A===C.length?(++I,w.next?s.head=w.next:s.head=s.tail=null):(s.head=w,w.data=C.slice(A));break}++I}return s.length-=I,f}function q(n){var s=n._readableState;if(s.length>0)throw new Error('"endReadable()" called on non-empty stream');s.endEmitted||(s.ended=!0,r.nextTick(ee,s,n))}function ee(n,s){!n.endEmitted&&n.length===0&&(n.endEmitted=!0,s.readable=!1,s.emit("end"))}function te(n,s){for(var f=0,w=n.length;f<w;f++)if(n[f]===s)return f;return-1}return Ze}var xt=J,ke=ce(),Bt=Object.create(x);Bt.inherits=_e;Bt.inherits(J,ke);function Jr(r,e){var t=this._transformState;t.transforming=!1;var i=t.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));t.writechunk=null,t.writecb=null,e!=null&&this.push(e),i(r);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function J(r){if(!(this instanceof J))return new J(r);ke.call(this,r),this._transformState={afterTransform:Jr.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",Qr)}function Qr(){var r=this;typeof this._flush=="function"?this._flush(function(e,t){mt(r,e,t)}):mt(this,null,null)}J.prototype.push=function(r,e){return this._transformState.needTransform=!1,ke.prototype.push.call(this,r,e)};J.prototype._transform=function(r,e,t){throw new Error("_transform() is not implemented")};J.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var a=this._readableState;(i.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}};J.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};J.prototype._destroy=function(r,e){var t=this;ke.prototype._destroy.call(this,r,function(i){e(i),t.emit("close")})};function mt(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}var ei=ve,Wt=xt,Ht=Object.create(x);Ht.inherits=_e;Ht.inherits(ve,Wt);function ve(r){if(!(this instanceof ve))return new ve(r);Wt.call(this,r)}ve.prototype._transform=function(r,e,t){t(null,r)};(function(r,e){e=r.exports=kt(),e.Stream=e,e.Readable=e,e.Writable=Ut(),e.Duplex=ce(),e.Transform=xt,e.PassThrough=ei})(Or,Oe);var ti=ii,ri=Object.prototype.hasOwnProperty;function ii(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var i in t)ri.call(t,i)&&(r[i]=t[i])}return r}var jt=Oe.Transform,Vt=tt.inherits,qt=ti;function fe(r){jt.call(this,r),this._destroyed=!1}Vt(fe,jt);fe.prototype.destroy=function(r){if(!this._destroyed){this._destroyed=!0;var e=this;W.nextTick(function(){r&&e.emit("error",r),e.emit("close")})}};function ni(r,e,t){t(null,r)}function it(r){return function(e,t,i){return typeof e=="function"&&(i=t,t=e,e={}),typeof t!="function"&&(t=ni),typeof i!="function"&&(i=null),r(e,t,i)}}Rr.exports=it(function(r,e,t){var i=new fe(r);return i._transform=e,t&&(i._flush=t),i});be.ctor=it(function(r,e,t){function i(a){if(!(this instanceof i))return new i(a);this.options=qt(r,a),fe.call(this,this.options)}return Vt(i,fe),i.prototype._transform=e,t&&(i.prototype._flush=t),i});be.obj=it(function(r,e,t){var i=new fe(qt({objectMode:!0,highWaterMark:16},r));return i._transform=e,t&&(i._flush=t),i});Object.defineProperty(Le,"__esModule",{value:!0});Le.storeTransformStream=void 0;const si=be;function ai(r){return si.obj((e,t,i)=>{try{const a=r(e);i(null,a);return}catch(a){i(a);return}})}Le.storeTransformStream=ai;(function(r){var e=$&&$.__createBinding||(Object.create?function(i,a,o,d){d===void 0&&(d=o),Object.defineProperty(i,d,{enumerable:!0,get:function(){return a[o]}})}:function(i,a,o,d){d===void 0&&(d=o),i[d]=a[o]}),t=$&&$.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&e(a,i,o)};Object.defineProperty(r,"__esModule",{value:!0}),t(Pe,r),t(Me,r),t(Ne,r),t(pe,r),t(Le,r)})(Qe);const ye={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord"},ie={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord",EMAIL_PASSWORDLESS:"torus-auth0-email-passwordless"},yt={[ie.GOOGLE]:"tkey-google",[ie.FACEBOOK]:"tkey-facebook",[ie.TWITCH]:"tkey-twitch",[ie.REDDIT]:"tkey-reddit",[ie.DISCORD]:"tkey-discord",[ie.EMAIL_PASSWORDLESS]:"tkey-auth0-email-passwordless"},k={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak",BANXA:"banxa"},B={MAINNET:"mainnet",MATIC:"matic",BSC_MAINNET:"bsc_mainnet",AVALANCHE_MAINNET:"avalanche_mainnet",XDAI:"xdai"},oi={PRODUCTION:"production",DEVELOPMENT:"development",BINANCE:"binance",TESTING:"testing",LRC:"lrc",BETA:"beta",BNB:"bnb",POLYGON:"polygon"},ue={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},li=["ETH","USDT","USDC","TUSD","EOSDT","USD","DAI","GUSD","DKKT","PAX","ILS","RUB","BYN","EUR","GBP","JPY","KRW","PLN","MXN","AUD","BRL","CAD","CHF","KPW","LAK","LBP","LKR","XOF","CNHT","DOGE","UAH","TRY","HKD","XJP","SGD","USC","NZD","NGN","RUR","COP","GHS","EGP","IDR","BHD","CRC","PEN","AED","DOP","PKR","HUF","VND","XAR","LTC","RON","OMR","MYR","DKK","UGX","ZMW","SAR","SEK","GEL","RWF","IRR","TZS","CNY","VEF","BDT","HRK","CLP","THB","XAF","ARS","UYU","SZL","KZT","NOK","KES","PAB","INR","CZK","MAD","TWD","PHP","ZAR","BOB","CDF","DASH","VES","ISK","MWK","BAM","TTD","XRP","JOD","RSD","HNL","BGN","GTQ","BWP","XMR","MMK","QAR","AOA","KWD","MUR","WUSD","WEUR","WAVES","WTRY","LRD","LSL","LYD","AWG","MDL","BTO","EURS","CHFT","MKD","MNT","MOP","MRO","MVR","VOLLAR","CKUSD","KHR","VUV","BITCNY","QC","BBD","NAD","NPR","PGK","PYG","BIF","BMD","BND","XLM","BNB","SCR","BAT","CRO","HT","KCS","LEO","LINK","MKR","NPXS","OMG","REP","ZB","ZIL","ZRX","BCH","BZD","CUP","CVE","DJF","DZD","ERN","ETB","FJD","FKP","BUSD","ANCT","ALL","AMD","ANG","CNYX","IQD","UZS","TND","GGP","XAU","KGS","GIP","JMD","ZEC","USDP","BSV","EMC2","SNT","GTO","POWR","EUSD","EURT","BCY","BTS","ATM","BLOCKPAY","ARDR","AMP","B2X","BITGOLD","BITEUR","ATB","BITUSD","AGRS","DFXT","HIKEN","BIX","KNC","EOS","COB","COSS","BMH","NANO","BDG","BNT","XVG","LKK1Y","LKK","USDK","EURN","NZDT","JSE","GMD","GNF","GYD","YER","XPF","HTG","SLL","SOS","WST","SVC","SYP","NEO","KMF","JUMP","AYA","BLAST","WGR","BCN","BTG","URALS","INN","USDQ","CNH","HUSD","BKRW","NZDX","EURX","CADX","USDEX","JPYX","AUDX","VNDC","EON","GBPX","CHFX","USDJ","IDRT","USDS","USDN","BIDR","IDK","BSD","BTN","KYD","NIO","SBD","SDG","SHP","TOP","XCD","XCHF","CNYT","GYEN","ZUSD","GOLD","TRX","TRYB","PLATC","STRAX","UST","GLM","VAI","BRZ","DDRST","XAUT","MIM"],ui={[k.MOONPAY]:["AUD","BGN","BRL","CAD","CHF","CNY","COP","CZK","DKK","DOP","EGP","EUR","GBP","HKD","HRK","IDR","ILS","JPY","JOD","KES","KRW","KWD","LKR","MAD","MXN","MYR","NGN","NOK","NZD","OMR","PEN","PKR","PLN","RON","RUB","SEK","SGD","THB","TRY","TWD","USD","VND","ZAR"],[k.WYRE]:["USD","EUR","GBP","AUD","CAD","NZD","ARS","BRL","CHF","CLP","COP","CZK","DKK","HKD","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","PHP","PLN","SEK","THB","VND","ZAR"],[k.RAMPNETWORK]:["USD","EUR","GBP"],[k.XANPOOL]:["SGD","HKD","THB","PHP","INR","IDR","MYR","AUD","NZD","KRW"],[k.MERCURYO]:["EUR","USD","GBP","TRY","JPY","BRL","NGN","VND","MXN","KRW"],[k.TRANSAK]:["ARS","AUD","BBD","BGN","BMD","BRL","CAD","CHF","CLP","CRC","CZK","DKK","DOP","EUR","FJD","FKP","GBP","GIP","HRK","HUF","IDR","ILS","ISK","JMD","JPY","KES","KRW","MDL","MXN","MYR","NOK","NZD","PEN","PHP","PLN","PYG","RON","SEK","SGD","THB","TRY","TZS","USD","ZAR"],[k.BANXA]:["EUR","GBP","USD"]},di=new Set(li);function re(r){return ui[r].filter(t=>di.has(t))}const hi={[k.MOONPAY]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:re(k.MOONPAY),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"aave",display:"AAVE"},{value:"bat",display:"BAT"},{value:"dai",display:"DAI"},{value:"eth",display:"ETH"},{value:"mkr",display:"MKR"},{value:"matic",display:"MATIC"},{value:"usdt",display:"USDT"},{value:"usdc",display:"USDC"}],[B.MATIC]:[{value:"eth_polygon",display:"ETH"},{value:"matic_polygon",display:"MATIC"},{value:"usdc_polygon",display:"USDC"}],[B.BSC_MAINNET]:[{value:"bnb_bsc",display:"BNB"},{value:"busd_bsc",display:"BUSD"}],[B.AVALANCHE_MAINNET]:[{value:"avax_cchain",display:"AVAX"}]},includeFees:!0,api:!0,enforceMax:!1},[k.WYRE]:{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30¢ or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:re(k.WYRE),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"BAT",display:"BAT"},{value:"BUSD",display:"BUSD"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"MKR",display:"MKR"},{value:"UNI",display:"UNI"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[B.MATIC]:[{value:"MUSDC",display:"USDC"}],[B.AVALANCHE_MAINNET]:[{value:"AVAXC",display:"AVAXC"}]},includeFees:!1,api:!0,enforceMax:!1},[k.RAMPNETWORK]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:re(k.RAMPNETWORK),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"DAI",display:"DAI"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[B.MATIC]:[{value:"MATIC_DAI",display:"DAI"},{value:"MATIC_MATIC",display:"MATIC"},{value:"MATIC_USDC",display:"USDC"}],[B.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}]},includeFees:!0,api:!0,receiveHint:"walletTopUp.receiveHintRamp",enforceMax:!1},[k.XANPOOL]:{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:re(k.XANPOOL),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"}]},includeFees:!0,api:!0,sell:!0,enforceMax:!1},[k.MERCURYO]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:re(k.MERCURYO),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"BAT",display:"BAT"},{value:"USDT",display:"USDT"},{value:"DAI",display:"DAI"}],[B.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"},{value:"1INCH",display:"1INCH"}]},includeFees:!0,api:!0,enforceMax:!1},[k.TRANSAK]:{line1:"Apple & Google Pay / Credit/Debit Card<br/>Bangkok Bank Mobile & iPay<br/>Bank Transfer (sepa/gbp) / SCB Mobile & Easy",line2:"0.99% - 5.5% or 5 USD",line3:"$5,000/day, $28,000/mo",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:30,maxOrderValue:500,validCurrencies:re(k.TRANSAK),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"ETH",display:"ETH"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"}],[B.MATIC]:[{value:"AAVE",display:"AAVE"},{value:"DAI",display:"DAI"},{value:"MATIC",display:"MATIC"},{value:"USDC",display:"USDC"},{value:"USDT",display:"USDT"},{value:"WETH",display:"WETH"}],[B.BSC_MAINNET]:[{value:"BNB",display:"BNB"},{value:"BUSD",display:"BUSD"}],[B.AVALANCHE_MAINNET]:[{value:"AVAX",display:"AVAX"}]},includeFees:!0,enforceMax:!0},[k.BANXA]:{line1:"Debit Card/ <br>Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://support.banxa.com",minOrderValue:20,maxOrderValue:15e3,validCurrencies:re(k.BANXA),validCryptoCurrenciesByChain:{[B.MAINNET]:[{value:"ETH",display:"ETH"},{value:"USDT",display:"USDT"},{value:"BUSD",display:"BUSD"},{value:"LINK",display:"LINK"},{value:"USDC",display:"USDC"},{value:"CHZ",display:"CHZ"},{value:"BAT",display:"BAT"},{value:"MANA",display:"MANA"},{value:"AAVE",display:"AAVE"},{value:"COMP",display:"COMP"},{value:"ENJ",display:"ENJ"}],[B.MATIC]:[{value:"MATIC",display:"MATIC"}]},includeFees:!0,enforceMax:!0}},ci={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}};var Y={supportedVerifierList:Object.values(ie),paymentProviders:hi,api:"https://api.tor.us",translations:ci,prodTorusUrl:"",localStorageKeyPrefix:"torus-"};const wt=r=>new Promise((e,t)=>{window.document.body!=null?Promise.resolve(r()).then(e).catch(t):window.document.addEventListener("DOMContentLoaded",()=>{Promise.resolve(r()).then(e).catch(t)})}),we=r=>{const e=window.document.createElement("template"),t=r.trim();return e.innerHTML=t,e.content.firstChild},fi=function(r,e,t){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];const d=()=>{t(...a),r.removeEventListener(e,d)};r.addEventListener(e,d)},G=(r,e,t)=>{const i=a=>{t(a),r.removeListener(e,i)};r.on(e,i)};async function pi(){return new Promise(r=>{document.readyState!=="loading"?r():fi(document,"DOMContentLoaded",r)})}var M=Zt.getLogger("torus-embed"),j={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",sendSiteMetadata:()=>"Torus: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:r=>`Torus: The Torus Ethereum provider does not support synchronous methods like ${r} without a callback parameter.`,invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:(r,e)=>`Invalid options. Received: { maxEventListeners: ${r}, shouldSendMetadata: ${e} }`,invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:r=>`'args.logger' must include required method '${r}'.`},info:{connected:r=>`Torus: Connected to chain with ID "${r}".`},warnings:{enableDeprecation:'Torus: ""ethereum.enable()" is deprecated and may be removed in the future. Please use "ethereum.send("eth_requestAccounts")" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',sendDeprecation:`Torus: "ethereum.send(...)" is deprecated and may be removed in the future. Please use "ethereum.sendAsync(...)" or "ethereum.request(...)" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,events:{close:`Torus: The event "close" is deprecated and may be removed in the future. Please use "disconnect" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,data:`Torus: The event "data" is deprecated and will be removed in the future.Use "message" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193#message`,networkChanged:`Torus: The event "networkChanged" is deprecated and may be removed in the future. Please use "chainChanged" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`,notification:`Torus: The event "notification" is deprecated and may be removed in the future. Please use "message" instead.
For more information, see: https://eips.ethereum.org/EIPS/eip-1193`},publicConfigStore:'Torus: The property "publicConfigStore" is deprecated and WILL be removed in the future.'}};const{paymentProviders:bt}=Y,gi=(r,e)=>{const t={};if(!r)return{errors:t,isValid:!0};if(r&&!bt[r])return t.provider="Invalid Provider",{errors:t,isValid:Object.keys(t).length===0};const i=bt[r],a=e||{};if(a.fiatValue){const o=+parseFloat(a.fiatValue.toString())||0;o<i.minOrderValue&&(t.fiatValue="Requested amount is lower than supported"),o>i.maxOrderValue&&i.enforceMax&&(t.fiatValue="Requested amount is higher than supported")}if(a.selectedCurrency&&!i.validCurrencies.includes(a.selectedCurrency)&&(t.selectedCurrency="Unsupported currency"),a.selectedCryptoCurrency){const o=Object.values(i.validCryptoCurrenciesByChain).flat().map(c=>c.value),d=r===k.MOONPAY?a.selectedCryptoCurrency.toLowerCase():a.selectedCryptoCurrency;o&&!o.includes(d)&&(t.selectedCryptoCurrency="Unsupported cryptoCurrency")}return{errors:t,isValid:Object.keys(t).length===0}};function mi(){return(r,e,t)=>{(typeof r.method!="string"||!r.method)&&(e.error=de.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:r})),t(i=>{const{error:a}=e;return a&&M.error(`MetaMask - RPC Error: ${a.message}`,a),i()})}}function vt(r,e,t){let i=`MetaMask: Lost connection to "${r}".`;e?.stack&&(i+=`
${e.stack}`),M.warn(i),t&&t.listenerCount("error")>0&&t.emit("error",i)}const ne=()=>Math.random().toString(36).slice(2),Kt=async(r,e)=>{let t,i;const a="1.41.1";let o=e.version||a;try{if((r==="binance"||r==="production")&&!e.version){let d;Y.prodTorusUrl?d={data:Y.prodTorusUrl}:d=await Mt(`${Y.api}/latestversion?name=@toruslabs/torus-embed&version=${a}`,{},{useAPIKey:!0}),o=d.data,Y.prodTorusUrl=d.data}}catch(d){M.error(d,"unable to fetch latest version")}switch(M.info("version used: ",o),r){case"binance":t=`https://binance.tor.us/v${o}`,i="info";break;case"testing":t="https://testing.tor.us",i="debug";break;case"bnb":t="https://bnb.tor.us",i="error";break;case"polygon":t="https://polygon.tor.us",i="error";break;case"lrc":t="https://lrc.tor.us",i="debug";break;case"beta":t="https://beta.tor.us",i="debug";break;case"development":t="http://localhost:4050",i="debug";break;default:t=`https://app.tor.us/v${o}`,i="error";break}return{torusUrl:t,logLevel:i}},_t=()=>{let r=window.navigator.language||"en-US";const e=r.split("-");return r=Object.prototype.hasOwnProperty.call(Y.translations,e[0])?e[0]:"en",r},yi=["eth_subscription"],Ft=()=>{},St="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",wi="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315",Ct="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";function bi(){const r=window.screenLeft!==void 0?window.screenLeft:window.screenX,e=window.screenTop!==void 0?window.screenTop:window.screenY,t=1200,i=700,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,d=1,c=Math.abs((a-t)/2/d+r),p=Math.abs((o-i)/2/d+e);return`titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${i/d},width=${t/d},top=${p},left=${c}`}function Et(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,i)}return t}function vi(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Et(Object(t),!0).forEach(function(i){b(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Et(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}Pt.defaultMaxListeners=100;const Tt=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(i,a)=>i||a.error?e(i||a.error):!t||Array.isArray(a)?r(a):r(a.result)};class xe extends Pt{constructor(e){let{maxEventListeners:t=100,shouldSendMetadata:i=!0,jsonRpcStreamName:a="provider"}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(super(),b(this,"chainId",void 0),b(this,"selectedAddress",void 0),b(this,"_rpcEngine",void 0),b(this,"networkVersion",void 0),b(this,"shouldSendMetadata",void 0),b(this,"isTorus",void 0),b(this,"_publicConfigStore",void 0),b(this,"tryPreopenHandle",void 0),b(this,"enable",void 0),b(this,"_state",void 0),b(this,"_jsonRpcConnection",void 0),b(this,"_sentWarnings",{enable:!1,experimentalMethods:!1,send:!1,publicConfigStore:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}}),!cr.duplex(e))throw new Error(j.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(t),this._state=vi({},xe._defaultState),this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.shouldSendMetadata=i,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._sendSync=this._sendSync.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._warnOfDeprecation=this._warnOfDeprecation.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this);const o=new Jt;Fe(e,o,e,this._handleStreamDisconnect.bind(this,"MetaMask")),this._publicConfigStore=new Qe.ObservableStore({storageKey:"Metamask-Config"}),Fe(o.createStream("publicConfig"),Qe.storeAsStream(this._publicConfigStore),vt.bind(this,"MetaMask PublicConfigStore")),o.ignoreStream("phishing"),this.on("connect",()=>{this._state.isConnected=!0});const d=Qt();Fe(d.stream,o.createStream(a),d.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider"));const c=new er;c.push(tr()),c.push(mi()),c.push(d.middleware),this._rpcEngine=c,d.events.on("notification",p=>{const{method:_,params:v}=p;_==="wallet_accountsChanged"?this._handleAccountsChanged(v):_==="wallet_unlockStateChanged"?this._handleUnlockStateChanged(v):_==="wallet_chainChanged"?this._handleChainChanged(v):yi.includes(p.method)&&(this.emit("data",p),this.emit("notification",v.result),this.emit("message",{type:_,data:v}))})}get publicConfigStore(){return this._sentWarnings.publicConfigStore||(M.warn(j.warnings.publicConfigStore),this._sentWarnings.publicConfigStore=!0),this._publicConfigStore}isConnected(){return this._state.isConnected}async request(e){if(!e||typeof e!="object"||Array.isArray(e))throw de.ethErrors.rpc.invalidRequest({message:j.errors.invalidRequestArgs(),data:e});const{method:t,params:i}=e;if(typeof t!="string"||t.length===0)throw de.ethErrors.rpc.invalidRequest({message:j.errors.invalidRequestMethod(),data:e});if(i!==void 0&&!Array.isArray(i)&&(typeof i!="object"||i===null))throw de.ethErrors.rpc.invalidRequest({message:j.errors.invalidRequestParams(),data:e});return new Promise((a,o)=>{this._rpcRequest({method:t,params:i},Tt(a,o))})}sendAsync(e,t){this._rpcRequest(e,t)}addListener(e,t){return this._warnOfDeprecation(e),super.addListener(e,t)}on(e,t){return this._warnOfDeprecation(e),super.on(e,t)}once(e,t){return this._warnOfDeprecation(e),super.once(e,t)}prependListener(e,t){return this._warnOfDeprecation(e),super.prependListener(e,t)}prependOnceListener(e,t){return this._warnOfDeprecation(e),super.prependOnceListener(e,t)}async _initializeState(){try{const{accounts:e,chainId:t,isUnlocked:i,networkVersion:a}=await this.request({method:"wallet_getProviderState"});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t,networkVersion:a}),this._handleUnlockStateChanged({accounts:e,isUnlocked:i}),this._handleAccountsChanged(e)}catch(e){M.error("MetaMask: Failed to get initial state. Please report this bug.",e)}finally{M.info("initialized state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=t;const o=e;if(!Array.isArray(o)){if(o.jsonrpc||(o.jsonrpc="2.0"),o.method==="eth_accounts"||o.method==="eth_requestAccounts")a=(d,c)=>{this._handleAccountsChanged(c.result||[],o.method==="eth_accounts",i),t(d,c)};else if(o.method==="wallet_getProviderState"){this._rpcEngine.handle(e,a);return}}this.tryPreopenHandle(o,a)}send(e,t){return this._sentWarnings.send||(M.warn(j.warnings.sendDeprecation),this._sentWarnings.send=!0),typeof e=="string"&&(!t||Array.isArray(t))?new Promise((i,a)=>{try{this._rpcRequest({method:e,params:t},Tt(i,a,!1))}catch(o){a(o)}}):e&&typeof e=="object"&&typeof t=="function"?this._rpcRequest(e,t):this._sendSync(e)}_sendSync(e){let t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,Ft),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw new Error(j.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),M.debug(j.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){this._state.isConnected=!1;let i;e?(i=new de.EthereumRpcError(1013,t||j.errors.disconnected()),M.debug(i)):(i=new de.EthereumRpcError(1011,t||j.errors.permanentlyDisconnected()),M.error(i),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",i)}}_handleStreamDisconnect(e,t){vt(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}_handleAccountsChanged(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=e;Array.isArray(a)||(M.error("MetaMask: Received non-array accounts parameter. Please report this bug.",a),a=[]);for(const o of e)if(typeof o!="string"){M.error("MetaMask: Received non-string account. Please report this bug.",e),a=[];break}fr(this._state.accounts,a)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!i&&M.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',a),this._state.accounts=a,this.emit("accountsChanged",a)),this.selectedAddress!==a[0]&&(this.selectedAddress=a[0]||null)}_handleChainChanged(){let{chainId:e,networkVersion:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!e||!t){M.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:e,networkVersion:t});return}t==="loading"?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId)))}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof t!="boolean"){M.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t});return}t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[]))}_warnOfDeprecation(e){this._sentWarnings.events[e]===!1&&(M.warn(j.warnings.events[e]),this._sentWarnings.events[e]=!0)}}b(xe,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});const _i=r=>({algorithms:r.algorithms||["sha256"],delimiter:r.delimiter||" ",full:r.full||!1}),Si=(r,e)=>{const t={};return r.algorithms.forEach(i=>{t[i]=ar(i).update(e,"utf8").digest("base64")}),t},Ci=(r,e)=>{let t="";return t+=Object.keys(e.hashes).map(i=>`${i}-${e.hashes[i]}`).join(r.delimiter),t},Ei=(r,e)=>{const t=_i(r),i={hashes:Si(t,e),integrity:void 0};return i.integrity=Ci(t,i),t.full?i:i.integrity};class At extends sr{constructor(e){let{url:t,target:i,features:a}=e;super(),b(this,"url",void 0),b(this,"target",void 0),b(this,"features",void 0),b(this,"window",void 0),b(this,"windowTimer",void 0),b(this,"iClosedWindow",void 0),this.url=t,this.target=i||"_blank",this.features=a||bi(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0),this.window===void 0&&clearInterval(this.windowTimer)},500))}open(){this.window=window.open(this.url.href,this.target,this.features),this.window?.focus&&this.window.focus()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}function Dt(r){return new Promise((e,t)=>{try{const i=document.createElement("img");i.onload=()=>e(!0),i.onerror=()=>e(!1),i.src=r}catch(i){t(i)}})}const Ti=r=>{const{document:e}=r,t=e.querySelector('head > meta[property="og:site_name"]');if(t)return t.content;const i=e.querySelector('head > meta[name="title"]');return i?i.content:e.title&&e.title.length>0?e.title:r.location.hostname};async function Ai(r){const{document:e}=r;let t=e.querySelector('head > link[rel="shortcut icon"]');return t&&await Dt(t.href)||(t=Array.from(e.querySelectorAll('head > link[rel="icon"]')).find(i=>!!i.href),t&&await Dt(t.href))?t.href:null}const Di=async()=>({name:Ti(window),icon:await Ai(window)});async function Ri(r){try{const e=await Di();r.handle({jsonrpc:"2.0",id:ne(),method:"wallet_sendDomainMetadata",params:e},Ft)}catch(e){M.error({message:j.errors.sendSiteMetadata(),originalError:e})}}const Oi=["host","chainId","networkName"];function Rt(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,i)}return t}function Ii(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rt(Object(t),!0).forEach(function(i){b(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Rt(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}const Pi={[ye.GOOGLE]:!0,[ye.FACEBOOK]:!0,[ye.REDDIT]:!0,[ye.TWITCH]:!0,[ye.DISCORD]:!0},Gt="sha384-TyJix2beanZzcdkcboa6uCUYMyLD0sGfvLb2m9+BJABgk4/kEutoxLOLL4Xex+DM",Mi="max-age=3600",Ni=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt","wallet_addEthereumChain","wallet_switchEthereumChain"];(async function(){try{if(typeof document>"u")return;const e=document.createElement("link"),{torusUrl:t}=await Kt("production",{check:!1,hash:Gt,version:""});e.href=`${t}/popup`,e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){M.warn(e)}})();class Li{constructor(){let{buttonPosition:e=ue.BOTTOM_LEFT,buttonSize:t=56,modalZIndex:i=99999,apiKey:a="torus-default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};b(this,"buttonPosition",ue.BOTTOM_LEFT),b(this,"buttonSize",void 0),b(this,"torusUrl",void 0),b(this,"torusIframe",void 0),b(this,"styleLink",void 0),b(this,"isLoggedIn",void 0),b(this,"isInitialized",void 0),b(this,"torusWidgetVisibility",void 0),b(this,"torusAlert",void 0),b(this,"apiKey",void 0),b(this,"modalZIndex",void 0),b(this,"alertZIndex",void 0),b(this,"torusAlertContainer",void 0),b(this,"isIframeFullScreen",void 0),b(this,"whiteLabel",void 0),b(this,"requestedVerifier",void 0),b(this,"currentVerifier",void 0),b(this,"embedTranslations",void 0),b(this,"ethereum",void 0),b(this,"provider",void 0),b(this,"communicationMux",void 0),b(this,"isLoginCallback",void 0),b(this,"paymentProviders",Y.paymentProviders),b(this,"loginHint",""),b(this,"useWalletConnect",void 0),b(this,"isCustomLogin",!1),this.buttonPosition=e,this.buttonSize=t,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.apiKey=a,or(a),this.modalZIndex=i,this.alertZIndex=i+1e3,this.isIframeFullScreen=!1}async init(){let{buildEnv:e=oi.PRODUCTION,enableLogging:t=!1,enabledVerifiers:i=Pi,network:a={host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""},loginConfig:o={},showTorusButton:d=!0,integrity:c={check:!1,hash:Gt,version:""},whiteLabel:p,skipTKey:_=!1,useWalletConnect:v=!1,mfaLevel:y="default"}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:R,logLevel:N}=await Kt(e,c);M.info(R,"url loaded"),this.torusUrl=R,this.whiteLabel=p,this.useWalletConnect=v,this.isCustomLogin=!!(o&&Object.keys(o).length>0)||!!(p&&Object.keys(p).length>0),M.setDefaultLevel(N),t?M.enableAll():M.disableAll(),this.torusWidgetVisibility=d;const O=new URL(R);O.pathname.endsWith("/")?O.pathname+="popup":O.pathname+="/popup",O.hash=`#isCustomLogin=${this.isCustomLogin}`,this.torusIframe=we(`<iframe
        id="torusIframe"
        allow=${v?"camera":""}
        class="torusIframe"
        src="${O.href}"
        style="display: none; position: fixed; top: 0; right: 0; width: 100%; color-scheme: none;
        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}"
      ></iframe>`),this.torusAlertContainer=we('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString());const E=window.document.createElement("link");E.setAttribute("rel","stylesheet"),E.setAttribute("type","text/css"),E.setAttribute("href",`${R}/css/widget.css`),this.styleLink=E;const{defaultLanguage:H=_t(),customTranslations:h={}}=this.whiteLabel||{},T=rr(Y.translations,h)[H]||Y.translations[_t()];this.embedTranslations=T.embed;const U=async()=>(await pi(),new Promise((L,X)=>{this.torusIframe.onload=async()=>{this._setupWeb3();const z=this.communicationMux.getStream("init_stream");z.on("data",Z=>{const{name:ae,data:oe,error:F}=Z;ae==="init_complete"&&oe.success?(this.isInitialized=!0,this._displayIframe(this.isIframeFullScreen),L(void 0)):F&&X(new Error(F))}),z.write({name:"init_stream",data:{enabledVerifiers:i,loginConfig:o,whiteLabel:this.whiteLabel,buttonPosition:this.buttonPosition,buttonSize:this.buttonSize,torusWidgetVisibility:this.torusWidgetVisibility,apiKey:this.apiKey,skipTKey:_,network:a,mfaLevel:y}})},window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}));if(e==="production"&&c.check){const L=`${R}/popup`,X=await fetch(L,{cache:"reload"});if(X.headers.get("Cache-Control")!==Mi)throw new Error(`Unexpected Cache-Control headers, got ${X.headers.get("Cache-Control")}`);const z=await X.text(),Z=Ei({algorithms:["sha384"]},z);if(M.info(Z,"integrity"),Z===c.hash)await U();else throw this.clearInit(),new Error("Integrity check failed")}else await U()}login(){let{verifier:e="",login_hint:t=""}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");return this.requestedVerifier=e,this.loginHint=t,this.ethereum.enable()}logout(){return new Promise((e,t)=>{if(!this.isLoggedIn){t(new Error("User has not logged in yet"));return}this.communicationMux.getStream("logout").write({name:"logOut"});const a=this.communicationMux.getStream("status");G(a,"data",d=>{d.loggedIn?t(new Error("Some Error Occured")):(this.isLoggedIn=!1,this.currentVerifier="",this.requestedVerifier="",e())})})}async cleanUp(){this.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(t){return t instanceof Element||t instanceof HTMLDocument}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}showTorusButton(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}setProvider(e){let{host:t="mainnet",chainId:i=null,networkName:a=""}=e,o=ir(e,Oi);return new Promise((d,c)=>{const p=this.communicationMux.getStream("provider_change");G(p,"data",y=>{const{err:R,success:N}=y.data;M.info(y),R?c(R):N?d():c(new Error("some error occured"))});const v=ne();this._handleWindow(v,{target:"_blank",features:St}),p.write({name:"show_provider_change",data:{network:Ii({host:t,chainId:i,networkName:a},o),preopenInstanceId:v,override:!1}})})}showWallet(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=this.communicationMux.getStream("show_wallet"),a=e?`/${e}`:"";i.write({name:"show_wallet",data:{path:a}}),G(i,"data",d=>{if(d.name==="show_wallet_instance"){const{instanceId:c}=d.data,p=new URL(`${this.torusUrl}/wallet${a}`);p.searchParams.append("integrity","true"),p.searchParams.append("instanceId",c),Object.keys(t).forEach(v=>{p.searchParams.append(v,t[v])}),p.hash=`#isCustomLogin=${this.isCustomLogin}`,new At({url:p,features:wi}).open()}})}async getPublicAddress(e){let{verifier:t,verifierId:i,isExtended:a=!1}=e;if(!Y.supportedVerifierList.includes(t)||!yt[t])throw new Error("Unsupported verifier");const o=t,d=yt[t],c=new URL("https://api.tor.us/lookup/torus");return c.searchParams.append("verifier",d),c.searchParams.append("verifierId",i),c.searchParams.append("walletVerifier",o),c.searchParams.append("network","mainnet"),c.searchParams.append("isExtended",a.toString()),Mt(c.href,{headers:{"Content-Type":"application/json; charset=utf-8"}},{useAPIKey:!0})}getUserInfo(e){return new Promise((t,i)=>{if(this.isLoggedIn){const a=this.communicationMux.getStream("user_info_access");a.write({name:"user_info_access_request"}),G(a,"data",d=>{const{name:c,data:{approved:p,payload:_,rejected:v,newRequest:y}}=d;if(c==="user_info_access_response"){if(p)t(_);else if(v)i(new Error("User rejected the request"));else if(y){const R=this.communicationMux.getStream("user_info");G(R,"data",E=>{E.name==="user_info_response"&&(E.data.approved?t(E.data.payload):i(new Error("User rejected the request")))});const O=ne();this._handleWindow(O,{target:"_blank",features:St}),R.write({name:"user_info_request",data:{message:e,preopenInstanceId:O}})}}})}else i(new Error("User has not logged in yet"))})}initiateTopup(e,t){return new Promise((i,a)=>{if(this.isInitialized){const{errors:o,isValid:d}=gi(e,t);if(!d){a(new Error(JSON.stringify(o)));return}const c=this.communicationMux.getStream("topup");G(c,"data",v=>{v.name==="topup_response"&&(v.data.success?i(v.data.success):a(new Error(v.data.error)))});const _=ne();this._handleWindow(_),c.write({name:"topup_request",data:{provider:e,params:t,preopenInstanceId:_}})}else a(new Error("Torus is not initialized yet"))})}async loginWithPrivateKey(e){const{privateKey:t,userInfo:i}=e;return new Promise((a,o)=>{if(this.isInitialized){if(It.from(t,"hex").length!==32){o(new Error("Invalid private key, Please provide a 32 byte valid secp25k1 private key"));return}const d=this.communicationMux.getStream("login_with_private_key");G(d,"data",p=>{p.name==="login_with_private_key_response"&&(p.data.success?a(p.data.success):o(new Error(p.data.error)))}),d.write({name:"login_with_private_key_request",data:{privateKey:t,userInfo:i}})}else o(new Error("Torus is not initialized yet"))})}async showWalletConnectScanner(){if(!this.useWalletConnect)throw new Error("Set `useWalletConnect` as true in init function options to use wallet connect scanner");return new Promise((e,t)=>{if(this.isLoggedIn){const i=this.communicationMux.getStream("wallet_connect_stream");G(i,"data",o=>{o.name==="wallet_connect_stream_res"&&(o.data.success?e(o.data.success):t(new Error(o.data.error)),this._displayIframe())}),i.write({name:"wallet_connect_stream_req"}),this._displayIframe(!0)}else t(new Error("User has not logged in yet"))})}_handleWindow(e){let{url:t,target:i,features:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e){const o=this.communicationMux.getStream("window"),d=new URL(t||`${this.torusUrl}/redirect?preopenInstanceId=${e}`);d.hash?d.hash+=`&isCustomLogin=${this.isCustomLogin}`:d.hash=`#isCustomLogin=${this.isCustomLogin}`;const c=new At({url:d,target:i,features:a});if(c.open(),!c.window){this._createPopupBlockAlert(e,d.href);return}o.write({name:"opened_window",data:{preopenInstanceId:e}});const p=_=>{let{preopenInstanceId:v,close:y}=_;v===e&&y&&(c.close(),o.removeListener("data",p))};o.on("data",p),c.once("close",()=>{o.write({data:{preopenInstanceId:e,closed:!0}}),o.removeListener("data",p)})}}_setEmbedWhiteLabel(e){const{theme:t}=this.whiteLabel||{};if(t){const{isDark:i=!1,colors:a={}}=t;i&&e.classList.add("torus-dark"),a.torusBrand1&&e.style.setProperty("--torus-brand-1",a.torusBrand1),a.torusGray2&&e.style.setProperty("--torus-gray-2",a.torusGray2)}}_getLogoUrl(){let e=`${this.torusUrl}/images/torus_icon-blue.svg`;return this.whiteLabel?.theme?.isDark?e=this.whiteLabel?.logoLight||e:e=this.whiteLabel?.logoDark||e,e}_sendWidgetVisibilityStatus(e){this.communicationMux.getStream("torus-widget-visibility").write({data:e})}_displayIframe(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t={},i=this.buttonSize+14;if(e)t.display="block",t.width="100%",t.height="100%",t.top="0px",t.right="0px",t.left="0px",t.bottom="0px";else switch(t.display=this.torusWidgetVisibility?"block":"none",t.height=`${i}px`,t.width=`${i}px`,this.buttonPosition){case ue.TOP_LEFT:t.top="0px",t.left="0px",t.right="auto",t.bottom="auto";break;case ue.TOP_RIGHT:t.top="0px",t.right="0px",t.left="auto",t.bottom="auto";break;case ue.BOTTOM_RIGHT:t.bottom="0px",t.right="0px",t.top="auto",t.left="auto";break;case ue.BOTTOM_LEFT:default:t.bottom="0px",t.left="0px",t.top="auto",t.right="auto";break}Object.assign(this.torusIframe.style,t),this.isIframeFullScreen=e}_setupWeb3(){M.info("setupWeb3 running");const e=new at({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),t=new at({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),i=new xe(e),a=v=>{const y=i[v];i[v]=function(N){if(N&&N==="eth_requestAccounts")return i.enable();for(var O=arguments.length,E=new Array(O>1?O-1:0),H=1;H<O;H++)E[H-1]=arguments[H];return y.apply(this,[N,...E])}};a("send"),a("sendAsync"),i.enable=()=>new Promise((v,y)=>{i.sendAsync({jsonrpc:"2.0",id:ne(),method:"eth_requestAccounts",params:[]},(R,N)=>{const{result:O}=N||{};if(R)setTimeout(()=>{y(R)},50);else if(Array.isArray(O)&&O.length>0){const E=()=>{if(this.requestedVerifier!==""&&this.currentVerifier!==this.requestedVerifier){const{requestedVerifier:H}=this;this.logout().then(h=>{this.requestedVerifier=H,this._showLoginPopup(!0,v,y)}).catch(h=>y(h))}else v(O)};this.isLoggedIn?E():this.isLoginCallback=E}else this._showLoginPopup(!0,v,y)})}),i.tryPreopenHandle=(v,y)=>{const R=v;if(!Array.isArray(R)&&Ni.includes(R.method)){const N=ne();this._handleWindow(N,{target:"_blank",features:Ct}),R.preopenInstanceId=N}i._rpcEngine.handle(R,y)};const o=new Proxy(i,{deleteProperty:()=>!0});this.ethereum=o;const d=nr(t);this.communicationMux=d,d.getStream("window").on("data",v=>{v.name==="create_window"&&this._createPopupBlockAlert(v.data.preopenInstanceId,v.data.url)}),d.getStream("widget").on("data",v=>{const{data:y}=v;this._displayIframe(y)}),d.getStream("status").on("data",v=>{v.loggedIn?(this.isLoggedIn=v.loggedIn,this.currentVerifier=v.verifier):this._displayIframe(),this.isLoginCallback&&(this.isLoginCallback(),delete this.isLoginCallback)}),this.provider=o,this.provider.shouldSendMetadata&&Ri(this.provider._rpcEngine),i._initializeState(),M.debug("Torus - injected provider")}_showLoginPopup(e,t,i){const a=d=>{const{err:c,selectedAddress:p}=d;c?(M.error(c),i&&i(c)):t&&t([p]),this.isIframeFullScreen&&this._displayIframe()},o=this.communicationMux.getStream("oauth");if(!this.requestedVerifier)this._displayIframe(!0),G(o,"data",a),o.write({name:"oauth_modal",data:{calledFromEmbed:e}});else{G(o,"data",a);const d=ne();this._handleWindow(d),o.write({name:"oauth",data:{calledFromEmbed:e,verifier:this.requestedVerifier,preopenInstanceId:d,login_hint:this.loginHint}})}}_createPopupBlockAlert(e,t){const i=this._getLogoUrl(),a=we(`<div id="torusAlert" class="torus-alert--v2"><div id="torusAlert__logo"><img src="${i}" /></div><div><h1 id="torusAlert__title">${this.embedTranslations.actionRequired}</h1><p id="torusAlert__desc">${this.embedTranslations.pendingAction}</p></div></div>`),o=we(`<div><a id="torusAlert__btn">${this.embedTranslations.continue}</a></div>`),d=we('<div id="torusAlert__btn-container"></div>');d.appendChild(o),a.appendChild(d);const c=()=>{o.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:Ct}),a.remove(),this.torusAlertContainer.children.length===0&&(this.torusAlertContainer.style.display="none")})};this._setEmbedWhiteLabel(a),wt(()=>{this.torusAlertContainer.style.display="block",this.torusAlertContainer.appendChild(a)}),wt(c)}}function Ot(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),t.push.apply(t,i)}return t}function Je(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ot(Object(t),!0).forEach(function(i){b(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ot(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}class Bi extends pr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),b(this,"name",Te.TORUS_EVM),b(this,"adapterNamespace",lr.EIP155),b(this,"currentChainNamespace",ur.EIP155),b(this,"type",dr.EXTERNAL),b(this,"status",K.NOT_READY),b(this,"torusInstance",null),b(this,"torusWalletOptions",void 0),b(this,"initParams",void 0),b(this,"loginSettings",{}),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{}}get provider(){return this.status===K.CONNECTED&&this.torusInstance?this.torusInstance.provider:null}set provider(e){throw new Error("Not implemented")}async init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};await super.init(e),super.checkInitializationRequirements();const{chainId:t,blockExplorer:i,displayName:a,rpcTarget:o,ticker:d,tickerName:c}=this.chainConfig,p={chainId:Number.parseInt(t,16),host:o,blockExplorer:i,networkName:a,ticker:d,tickerName:c};this.torusInstance=new Li(this.torusWalletOptions),Ge.debug("initializing torus evm adapter init"),await this.torusInstance.init(Je(Je({showTorusButton:!1},this.initParams),{},{network:p})),this.status=K.READY,this.emit($e.READY,Te.TORUS_EVM);try{Ge.debug("initializing torus evm adapter"),e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(_){Ge.error("Failed to connect with torus evm provider",_),this.emit($e.ERRORED,_)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw Ae.notReady("Torus wallet is not initialized");this.status=K.CONNECTING,this.emit($e.CONNECTING,{adapter:Te.TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);const{chainId:e}=this.torusInstance.provider;if(e&&parseInt(e)!==parseInt(this.chainConfig.chainId,16)){const{chainId:t,blockExplorer:i,displayName:a,rpcTarget:o,ticker:d,tickerName:c}=this.chainConfig,p={chainId:Number.parseInt(t,16),host:o,blockExplorer:i,networkName:a,tickerName:c,ticker:d};await this.torusInstance.setProvider(Je({},p));const _=await this.torusInstance.ethereum.request({method:"eth_chainId"});if(_&&parseInt(_)!==parseInt(this.chainConfig.chainId,16))throw Ae.fromCode(5e3,`Not connected to correct chainId. Expected: ${this.chainConfig.chainId}, Current: ${_}`)}return this.status=K.CONNECTED,this.torusInstance.showTorusButton(),this.emit(K.CONNECTED,{adapter:Te.TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(e){throw this.status=K.READY,this.rehydrated=!1,this.emit(K.ERRORED,e),e instanceof hr?e:ot.connectionError("Failed to login with torus wallet")}}async disconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cleanup:!1};if(await super.disconnectSession(),!this.torusInstance)throw Ae.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),e.cleanup?(this.status=K.NOT_READY,this.torusInstance=null):this.status=K.READY,await super.disconnect()}async getUserInfo(){if(this.status!==K.CONNECTED)throw ot.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw Ae.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo("")}}export{Bi as TorusWalletAdapter};
